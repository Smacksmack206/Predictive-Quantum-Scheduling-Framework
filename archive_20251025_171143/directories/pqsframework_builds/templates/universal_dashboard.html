<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal PQS Framework</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .system-info {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-card h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #fff;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        
        .btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .btn.primary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-active { background: #2ecc71; }
        .status-warning { background: #f39c12; }
        .status-error { background: #e74c3c; }
        
        .architecture-badge {
            display: inline-block;
            background: linear-gradient(45deg, #3742fa, #2f3542);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-left: 10px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
        }
        
        .spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid #fff;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid rgba(231, 76, 60, 0.5);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç Universal PQS Framework</h1>
            <p>Quantum Energy Management for All Mac Architectures</p>
        </div>
        
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Initializing Universal PQS System...</p>
        </div>
        
        <div id="error" class="error-message" style="display: none;">
            <h3>‚ö†Ô∏è System Error</h3>
            <p id="error-message">Unable to connect to PQS system</p>
        </div>
        
        <div id="dashboard" style="display: none;">
            <div class="system-info">
                <h2>
                    <span class="status-indicator status-active"></span>
                    System Status
                    <span id="architecture-badge" class="architecture-badge">Unknown</span>
                </h2>
                <div style="margin-top: 15px;">
                    <div><strong>Chip:</strong> <span id="chip-model">Detecting...</span></div>
                    <div><strong>Optimization Tier:</strong> <span id="optimization-tier">Unknown</span></div>
                    <div><strong>Max Qubits:</strong> <span id="max-qubits">0</span></div>
                    <div><strong>Capabilities:</strong> <span id="capabilities">Loading...</span></div>
                </div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>‚öõÔ∏è Quantum System</h3>
                    <div class="metric-value" id="qubits-available">0</div>
                    <div class="metric-label">Qubits Available</div>
                    <div style="margin-top: 10px;">
                        <div>Operations: <span id="quantum-operations">0</span></div>
                        <div>Optimizations: <span id="optimizations-run">0</span></div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <h3>‚ö° Energy Optimization</h3>
                    <div class="metric-value" id="energy-saved">0.0%</div>
                    <div class="metric-label">Total Energy Saved</div>
                    <div style="margin-top: 10px;">
                        <div>Efficiency Score: <span id="efficiency-score">0</span>%</div>
                        <div>Thermal State: <span id="thermal-state">Normal</span></div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <h3>üíª System Metrics</h3>
                    <div class="metric-value" id="cpu-percent">0%</div>
                    <div class="metric-label">CPU Usage</div>
                    <div style="margin-top: 10px;">
                        <div>Memory: <span id="memory-percent">0</span>%</div>
                        <div>Battery: <span id="battery-level">0</span>%</div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <h3>üß† ML Acceleration</h3>
                    <div class="metric-value" id="ml-models">0</div>
                    <div class="metric-label">Models Trained</div>
                    <div style="margin-top: 10px;">
                        <div>Uptime: <span id="system-uptime">0.0</span>h</div>
                        <div>Architecture: <span id="system-architecture">Unknown</span></div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn primary" onclick="runOptimization()">‚ö° Run Optimization</button>
                <button class="btn" onclick="refreshData()">üîÑ Refresh Data</button>
                <button class="btn" onclick="viewDetails()">üìä View Details</button>
            </div>
        </div>
    </div>

    <script>
        let systemData = null;
        
        async function loadSystemData() {
            try {
                const response = await fetch('/api/status');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                systemData = await response.json();
                
                if (systemData.error) {
                    throw new Error(systemData.error);
                }
                
                updateDashboard();
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                
            } catch (error) {
                console.error('Error loading system data:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                document.getElementById('error-message').textContent = error.message;
            }
        }
        
        function updateDashboard() {
            if (!systemData) return;
            
            const { system_info, capabilities, stats, real_time_metrics } = systemData;
            
            // System info
            document.getElementById('chip-model').textContent = system_info.chip_model;
            document.getElementById('optimization-tier').textContent = system_info.optimization_tier;
            document.getElementById('max-qubits').textContent = capabilities.max_qubits;
            
            // Architecture badge
            const badge = document.getElementById('architecture-badge');
            if (system_info.architecture === 'apple_silicon') {
                badge.textContent = 'Apple Silicon';
                badge.style.background = 'linear-gradient(45deg, #ff6b6b, #ee5a24)';
            } else if (system_info.architecture === 'intel') {
                badge.textContent = 'Intel Mac';
                badge.style.background = 'linear-gradient(45deg, #3742fa, #2f3542)';
            } else {
                badge.textContent = 'Unknown';
                badge.style.background = 'linear-gradient(45deg, #57606f, #2f3542)';
            }
            
            // Capabilities
            const capList = [];
            if (capabilities.quantum_simulation) capList.push('Quantum');
            if (capabilities.gpu_acceleration) capList.push('GPU');
            if (capabilities.neural_engine) capList.push('Neural Engine');
            if (capabilities.metal_support) capList.push('Metal');
            document.getElementById('capabilities').textContent = capList.join(', ') || 'Basic';
            
            // Metrics
            document.getElementById('qubits-available').textContent = stats.qubits_available;
            document.getElementById('quantum-operations').textContent = stats.quantum_operations;
            document.getElementById('optimizations-run').textContent = stats.optimizations_run;
            document.getElementById('energy-saved').textContent = stats.energy_saved.toFixed(1) + '%';
            document.getElementById('efficiency-score').textContent = Math.round(stats.power_efficiency_score);
            document.getElementById('thermal-state').textContent = stats.thermal_state;
            document.getElementById('ml-models').textContent = stats.ml_models_trained;
            document.getElementById('system-uptime').textContent = stats.system_uptime.toFixed(1);
            document.getElementById('system-architecture').textContent = stats.system_architecture;
            
            // Real-time metrics
            if (real_time_metrics) {
                document.getElementById('cpu-percent').textContent = Math.round(real_time_metrics.cpu_percent) + '%';
                document.getElementById('memory-percent').textContent = Math.round(real_time_metrics.memory_percent);
                document.getElementById('battery-level').textContent = real_time_metrics.battery_level;
            }
        }
        
        async function runOptimization() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚ö° Optimizing...';
            btn.disabled = true;
            
            try {
                const response = await fetch('/api/optimize', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ Optimization completed successfully!');
                    refreshData();
                } else {
                    alert('‚ö†Ô∏è ' + result.message);
                }
                
            } catch (error) {
                alert('‚ùå Optimization failed: ' + error.message);
            } finally {
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }
        
        function refreshData() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            loadSystemData();
        }
        
        function viewDetails() {
            if (!systemData) return;
            
            const details = `Universal PQS System Details

üèóÔ∏è Architecture: ${systemData.system_info.chip_model}
üéØ Optimization Tier: ${systemData.system_info.optimization_tier}
‚öõÔ∏è Max Qubits: ${systemData.capabilities.max_qubits}

üìä Performance Statistics:
‚Ä¢ Optimizations Run: ${systemData.stats.optimizations_run}
‚Ä¢ Energy Saved: ${systemData.stats.energy_saved.toFixed(1)}%
‚Ä¢ Quantum Operations: ${systemData.stats.quantum_operations}
‚Ä¢ ML Models Trained: ${systemData.stats.ml_models_trained}
‚Ä¢ System Uptime: ${systemData.stats.system_uptime.toFixed(1)} hours

üîß Capabilities:
‚Ä¢ Quantum Simulation: ${systemData.capabilities.quantum_simulation ? 'Yes' : 'No'}
‚Ä¢ GPU Acceleration: ${systemData.capabilities.gpu_acceleration ? 'Yes' : 'No'}
‚Ä¢ Neural Engine: ${systemData.capabilities.neural_engine ? 'Yes' : 'No'}
‚Ä¢ Metal Support: ${systemData.capabilities.metal_support ? 'Yes' : 'No'}
‚Ä¢ Unified Memory: ${systemData.capabilities.unified_memory ? 'Yes' : 'No'}

üå°Ô∏è Current State:
‚Ä¢ Thermal State: ${systemData.stats.thermal_state}
‚Ä¢ Power Efficiency: ${Math.round(systemData.stats.power_efficiency_score)}%
‚Ä¢ CPU Usage: ${Math.round(systemData.real_time_metrics.cpu_percent)}%
‚Ä¢ Memory Usage: ${Math.round(systemData.real_time_metrics.memory_percent)}%
‚Ä¢ Battery Level: ${systemData.real_time_metrics.battery_level}%`;

            alert(details);
        }
        
        // Auto-refresh every 30 seconds
        setInterval(() => {
            if (document.getElementById('dashboard').style.display !== 'none') {
                loadSystemData();
            }
        }, 30000);
        
        // Initial load
        loadSystemData();
    </script>
</body>
</html>